---
title: "Analisis Variansi Dua Arah pada Dataset thaltb.dat.txt"
author: "Sahda Huwaidah Estiningtyas"
output: html_document
date: '2024-04-23'
---

#### Berdasarkan dataset thaltb.dat.txt akan dilakukan analisis variansi dua arah untuk mengetahui pengaruh antara perlakuan HIV tipe 1 dan M (treatment) dan status tuberculosis (tb) terhadap pertumbuhan berat badan (weight).

    Dataset:  thaltb.dat.txt
    Source: J.D. Klausner, S.Makonkawkeyoon, P.Akarasewi, et al (1996). 
    "The Effect of Thalidomide on the Pathogenesis of Human Immunodeficiency Virus Type 1 and M. Tuberculosis Infection", Journal of Acquired Immune Deficiency Syndroms and Human Retrovirology. Vol. 11, pp247-257.
    Description: Effect of Thalidomide versus Placebo on weight gain in HIV+ subjects with and without TB.

    Variables/Columns:
    Treatment  7  /* 1=Thalidomide, 0=Placebo   */
    TB status  14   /* 1=Positive,  0=Negative  */
    Weight gain  18-21  /* Kilograms over 21-day period  */

### Menyiapkan dataset
```{r}
thaltb <- read.table("C:/Users/LENOVO/OneDrive/Documents/UNY/Semester 2/thaltb.dat.txt",header=F,col.names=c("treatment","tb","weight"))
thaltb$treatment <- factor(thaltb$treatment)
levels(thaltb$treatment) <- c("Placebo","Thalidomide")
thaltb$tb <- factor(thaltb$tb)
levels(thaltb$tb) <- c("Negative","Positive")
str(thaltb)

head(thaltb,n=3)
```

# A. Membuat plot rata-rata respons dan memberikan interpretasi
```{r}
attach(thaltb)
interaction.plot(x.factor=treatment, trace.factor=tb, response=weight, fun=mean, type="b", legend=TRUE, xlab="Treatment", ylab="Weight", pch=c(1,19), col=c("red", "blue"), lwd=2)
```

**Interpretasi:**

- Terlihat adanya garis-garis yang paralel sehingga mengindikasikan tidak adanya pengaruh interaksi antara
perlakuan HIV tipe 1 dan M (treatment) dan status tuberculosis (tb) terhadap rata-rata pertumbuhan berat badan (weight).

- Dari plot terlihat bahwa rata-rata pertumbuhan berat badan (weight) bagi semua interaksi antara perlakuan HIV tipe 1 dan M (treatment) lebih tinggi pada status tuberculosis (tb) positif dibanding status tuberculosis (tb) negatif

- Pada treatment placebo, terlihat adanya perbedaan rata-rata pertumbuhan berat badan (weight) yang cukup besar antara status tuberculosis (tb) positif dan negatif. Sedangkan pada treatment thalidomide, terlihat adanya perbedaan rata-rata pertumbuhan berat badan (weight) yang signifikan antara status tuberculosis
(tb) positive dan negative. Hal ini men gindikasikan tidak adanya pengaruh status tuberculosis (tb) terhadap pertumbuhan berat badan (weight).

- Pada status tuberculosis positif dan negative, rata-rata pertumbuhan berat badan dari kedua jenis treatment sedikit berbeda. Hal ini mengindikasikan tidak ada pengaruh jenis treatment terhadap rata -rata pertumbuhan berat badan.

# B. Menentukan hipotesis nol dan hipotesis alternatif dalam kalimat dan simbol
### Hipotesis dalam kalimat:

**Uji Bagi Pengaruh interaksi**

- ğ»0: Tidak ada pengaruh antara treatment dan status tuberculosis terhadap pertumbuhan berat badan

- ğ»1: Ada pengaruh antara treatment dan status tuberculosis terhadap pertumbuhan berat badan

**Uji Pengaruh faktor A (Treatment)**

- ğ»0: Tidak ada pengaruh antara treatment terhadap pertumbuhan berat badan

- ğ»1: Ada pengaruh antara treatment terhadap pertumbuhan berat badan 

**Uji Bagi Pengaruh faktor B (tb)**

- ğ»0: Tidak ada pengaruh antara status tuberculosis terhadap pertumbuhan berat badan

- ğ»1: Ada pengaruh antara status tuberculosis terhadap pertumbuhan berat badan

### Hipotesis dalam simbol:

**Hipotesis interaksi**

- ğ»0: (âˆ ğ›½)11 = (âˆ ğ›½)12 = (âˆ ğ›½)21 = (âˆ ğ›½)22 = 0

- ğ»1: âˆƒ(âˆ ğ›½)ğ‘–ğ‘— â‰  0, ğ‘– = 1,2;ğ‘— = 1,2

**Hipotesis faktor A**

- ğ»0: ğ‘1 = ğ‘2 = 0

- ğ»1: âˆƒğ‘ğ‘– â‰  0, ğ‘– = 1,2

**Hipotesis faktor B**

- ğ»0: ğ›½1 = ğ›½2 = 0

- ğ»1: âˆƒğ›½ğ‘— â‰  0,ğ‘— = 1,2

# C. Menentukan kriteria keputusan yang bersesuaian
### Uji Bagi Pengaruh interaksi

**Hipotesis:**

- ğ»0: \((âˆ ğ›½)_{11} = (âˆ ğ›½)_{12} = (âˆ ğ›½)_{21} = (âˆ ğ›½)_{2} = 0 \) (Tidak ada pengaruh antara treatment dan status tuberculosis terhadap pertumbuhan berat badan)

- ğ»1: \(âˆƒ(âˆ ğ›½)_{ij} â‰  0, i = 1,2; j = 1,2\) (Ada pengaruh antara treatment dan status tuberculosis terhadap pertumbuhan berat badan)

**Taraf signifikansi:**

- âˆ = 0.05

**Statistik uji:**

- \( F_{AB} = \frac{KTAB}{KTG} \)

**Kriteria Keputusan:**

- \( a=2, b=2, n=8, F_{0.05((a-1)(b-1), ab(n-1))} = F_{0.05(1, 28)} = 4.196 \)

- \( H_0 \) ditolak jika \( F_{AB} > 4.196 \) atau \( H_0 \) ditolak jika p-value < 0.05

**Hitungan:**

\( F_{AB} = \frac{KTAB}{KTG} = \frac{JKAB/(a-1)(b-1)}{JKG/ab(n-1)} = \frac{21.125â„1}{100.3125â„28} = 5.89657\)

```{r}
# Dengan Program R
a <- nlevels(treatment)
a

b <- nlevels(tb)
b

n = 8
n

qf(0.95, df1=(a-1)*(b-1), df2=a*b*(n-1))

p.value <- 1-pf(5.89657, df1=(a-1)*(b-1), df2=a*b*(n-1))
p.value
```

**Kesimpulan:**

\( F_{AB} = 5.89657, p-value = 0.0218\) 

Oleh karena \( F_{AB} = 5.89657 > 4.196\) atau p-value = 0.0218 < 0.05, maka \( H_0 \) ditolak. Sehingga ada pengaruh antara treatment dan status tuberculosis terhadap pertumbuhan berat badan.

### Uji Bagi  Pengaruh faktor A (Treatment)

**Hipotesis:**

- ğ»0: \(a_{1} = a_{2} = 0 \) (Tidak ada pengaruh antara treatment terhadap pertumbuhan berat badan)

- ğ»1: \(âˆƒa_{i} â‰  0, i = 1,2 \) (Ada pengaruh antara treatment terhadap pertumbuhan berat badan)

**Taraf signifikansi:**

- âˆ = 0.05

**Statistik uji:**

- \( F_{A} = \frac{KTA}{KTG} \)

**Kriteria Keputusan:**

- \( a=2, b=2, n=8, F_{0.05((a-1), ab(n-1))} = F_{0.05(1, 28)} = 4.196 \)

- \( H_0 \) ditolak jika \( F_{A} > 4.196 \) atau \( H_0 \) ditolak jika p-value < 0.05

**Hitungan:**

\( F_{A} = \frac{KTA}{KTG} = \frac{JKA/(a-1)}{JKG/ab(n-1)} = \frac{0.78125â„1}{100.3125â„28} = 0.21807\)

```{r}
# Dengan Program R
qf(0.95, df1=(a-1)*(b-1), df2=a*b*(n-1))

p.value.A <- 1-pf(0.21807, df1=(a-1)*(b-1), df2=a*b*(n-1))
p.value.A
```

**Kesimpulan:**

\( F_{A} = 0.21807, p-value = 0.644128\) 

Oleh karena \( F_{A} = 0.21807 < 4.196\) atau p-value = 0.644128 > 0.05, maka \( H_0 \) tidak ditolak. Sehingga tidak ada pengaruh antara treatment terhadap pertumbuhan berat badan.

### Uji Bagi  Pengaruh faktor B (tb)

**Hipotesis:**

- ğ»0: \(ğ›½_{1} = ğ›½_{2} = 0 \) (Tidak ada pengaruh antara status tuberculosis terhadap pertumbuhan berat badan)

- ğ»1: \(âˆƒğ›½_{j} â‰  0, j = 1,2\) (Ada pengaruh antara status tuberculosis terhadap pertumbuhan berat badan)

**Taraf signifikansi:**

- âˆ = 0.05

**Statistik uji:**

- \( F_{B} = \frac{KTB}{KTG} \)

**Kriteria Keputusan:**

- \( a=2, b=2, n=8, F_{0.05((b-1), ab(n-1))} = F_{0.05(1, 28)} = 4.196 \)

- \( H_0 \) ditolak jika \( F_{B} > 4.196 \) atau \( H_0 \) ditolak jika p-value < 0.05

**Hitungan:**

\( F_{B} = \frac{KTB}{KTG} = \frac{JKB/(b-1)}{JKG/ab(n-1)} = \frac{87.78125/1}{100.3125â„28} = 24.50218\)

```{r}
# Dengan Program R
qf(0.95, df1=(a-1)*(b-1), df2=a*b*(n-1))

p.value.B <- 1-pf(24.50218, df1=(a-1)*(b-1), df2=a*b*(n-1))
p.value.B
```

**Kesimpulan:**

\( F_{B} = 24.50218, p-value = 3.1799ğ‘’-05\) 

Oleh karena \( F_{B} = 24.50218 > 4.196\) atau p-value = 3.1799ğ‘’-05 < 0.05, maka \( H_0 \) ditolak. Sehingga ada pengaruh antara status tuberculosis terhadap pertumbuhan berat badan.

# D. Membuat tabel ANOVA dan memberikan kesimpulan
```{r}
# ANOVA
options(digits = 10)
fit <- aov(weight ~ treatment*tb, data=thaltb)
summary(fit)
```

**Kesimpulan Uji bagi Pengaruh Interaksi**

Karena \( F_{AB} = 5.89657 > 4.196\) atau p-value = 0.0218 < 0.05, maka \( H_0 \) ditolak. Jadi, pada taraf signifikansi 0.05 dapat disimpulkan bahwa ada pengaruh antara treatment dan status tuberculosis terhadap pertumbuhan berat badan.

**Kesimpulan Uji bagi Pengaruh Utama Faktor A (Treatment)**

Karena \( F_{A} = 0.21807 < 4.196\) atau p-value = 0.644128 > 0.05, maka \( H_0 \) tidak ditolak. Jadi, pada taraf signifikansi 0.05 dapat disimpulkan bahwa tidak ada pengaruh antara treatment terhadap pertumbuhan berat badan.

**Kesimpulan Uji bagi Pengaruh  Utama Faktor B (tb)**

Karena \( F_{B} = 24.50218 > 4.196\) atau p-value = 3.1799ğ‘’-05 < 0.05, maka \( H_0 \) ditolak. Jadi, pada taraf signifikansi 0.05 dapat disimpulkan bahwa ada pengaruh antara status tuberculosis terhadap pertumbuhan berat badan.

Kesimpulan tambahan:

- Hipotesis nol pada pengaruh interaksi ditolak, maka ada bukti interaksi yang signifikan.
- Hipotesis nol pada pengaruh faktor A tidak ditolak, maka pengaruh faktor A tidak dapat disimpulkan.
- Hipotesis nol pada pengaruh faktor B ditolak, maka pengaruh faktor B mungkin signifikan.

# E. Jika hipotesis pada pengaruh interaksi ditolak, lakukan perbandingan berganda dengan prosedur Tukey. Berikan kesimpulan dan rekomendasi. Gunakan ğ›¼ = 0.05.
```{r}
TukeyHSD(fit, which = "treatment:tb", conf.level = 0.95)
```

- IK 95% bagi \( Î¼_{Thalidomide:Positive} - Î¼_{Thalidomide:Negative} \) adalah 2.3535701068 dan 7.5214298932 tidak memuat 0. Sehingga dapat disimpulkan bahwa treatment thalidomide dengan status tuberculosis negative tidak lebih tinggi dibandingkan dengan treatment thalidomide dengan status tuberculosis positive \( Î¼_{Thalidomide:Positive} > Î¼_{Thalidomide:Negative} \)

- IK 95% bagi \( Î¼_{Placebo:Positive} - Î¼_{Thalidomide:Negative} \) adalah 1.0410701068 dan 6.2089298932 tidak memuat 0. Sehingga dapat disimpulkan bahwa treatment thalidomide dengan status tuberculosis negative tidak lebih tinggi dibandingkan dengan treatment placebo dengan status tuberculosis positive \( Î¼_{Placebo:Positive} > Î¼_{Thalidomide:Negative} \)

- IK 95% bagi \( Î¼_{Thalidomide:Positive} - Î¼_{Thalidomide:Negative} \) adalah 0.4160701068 dan 5.5839298932 tidak memuat 0. Sehingga dapat disimpulkan bahwa treatment placebo dengan status tuberculosis negative tidak lebih tinggi dibandingkan dengan treatment thalidomide dengan status tuberculosis positive \( Î¼_{Thalidomide:Positive} > Î¼_{Thalidomide:Negative} \)

- IK 95% bagi bagi beda dua rata-rata pertambahan berat badan dari treatment dan status tuberculosis lain memuat 0. Sehingga tidak ada perbedaan \( Î¼_{Thalidomide:Positive} = Î¼_{Placebo:Negative}, Î¼_{Placebo:Positive} - Î¼_{Placebo:Negative}, Î¼_{Thalidomide:Positive} - Î¼_{Placebo:Positive}\)

# F. Jika hipotesis pada pengaruh interaksi tidak ditolak, lakukan perbandingan berganda dengan prosedur Tukey. Berikan kesimpulan dan rekomendasi. Gunakan ğ›¼ = 0.05.
- Hipotesis pada pengaruh interaksi ditolak. Ada pengaruh interaksi antara
treatment dan status tuberculosis terhadap perubahan berat badan. 

# G. Pengecekan asumsi normalitas dan homogenitas variansi

```{r}
thaltb$int <- with(thaltb, interaction(treatment,tb), drop=TRUE)
levels(thaltb$int)

bartlett.test(weight~int, data=thaltb)
```

```{r}
grup1 <- subset(thaltb$weight, thaltb$int=="Placebo.Negative")
shapiro.test(grup1)
```

```{r}
grup2 <- subset(thaltb$weight, thaltb$int=="Thalidomide.Negative")
shapiro.test(grup2)
```

```{r}
grup3 <- subset(thaltb$weight, thaltb$int=="Placebo.Positive")
shapiro.test(grup3)
```

```{r}
grup4 <- subset(thaltb$weight, thaltb$int=="Thalidomide.Positive")
shapiro.test(grup4)
```

```{r}
# Ekstrak residual
aov_residuals <- residuals(object=fit)
# Uji Shapiro-Wilk
shapiro.test(x=aov_residuals)
```